<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAPA-RD | RPT-2026-001</title>
    <link rel="stylesheet" href="../theme/report.css">
    <link rel="stylesheet" href="../theme/report.print.css" media="print">
</head>

<body class="theme-dark">
    <div class="container">

        <!-- Cover Section -->
        <div class="cover-wrapper">
    <!-- Hero / Top -->
    <div class="hero-top">
        <svg class="lock-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
            aria-hidden="true">
            <rect x="3" y="11" width="18" height="11" rx="2" />
            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        </svg>

        <div class="tag">OSINT + ARCO + PROTECCIÓN DE DATOS</div>
    </div>

    <h1>MAPA-RD: Exposición y Ruta de Cierre</h1>

    <div class="divider"></div>

    <p class="subtitle">
        Así se ve tu entorno digital desde fuera. Esto es lo que hay que cerrar primero.
    </p>

    <p class="description">
        MAPA-RD identifica exposición real (visible públicamente), prioriza riesgos y entrega una ruta de cierre
        ejecututable.
        Incluye base operativa para gestión ARCO y un esquema mensual de control continuo.
        <br><br>
        <strong>Sin auditorías genéricas. Sin promesas vacías.</strong>
    </p>

    <!-- Quiet Depth Layer 2: Divider Fade -->
    <div class="divider-fade"></div>

    <!-- Metadata Editorial Block (Quiet Depth Layer 3) -->
    <div class="meta-block">
        <div class="meta-line-primary">
            ACME Corp &middot; Reporte RPT-2026-001 &middot; 2026-01-11
        </div>
        <div class="meta-line-secondary">
            Reporte Ejecutivo de Seguridad &middot; Exposición pública &middot; Confidencial
        </div>
    </div>
</div>

        <!-- IRD Section (Premium Page) -->
        <div class="page-break"></div>

<section class="ird-page">
    <div class="ird-container">
        <h2 class="section-title-center">Índice de Riesgo Digital</h2>

        <!-- Updated to IRD Box (Rounded Rectangle) -->
        <!-- 'final-score' attribute holds the value for JS animation. Content is pre-filled for PDF static render. -->
        <div class="ird-box critical" id="irdBox">
            <span class="ird-score" id="irdScore" data-target="65">65</span>
            <span class="ird-label critical">Riesgo Crítico</span>
        </div>


    </div>
</section>

<!-- Progressive Animation Script (Browser Only - Ignored by PDF Renderer) -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Only run if elements exist
        const scoreEl = document.getElementById('irdScore');
        const boxEl = document.getElementById('irdBox');
        const labelEl = boxEl ? boxEl.querySelector('.ird-label') : null;

        if (!scoreEl || !boxEl || !labelEl) return;

        const targetScore = parseInt(scoreEl.getAttribute('data-target'), 10);
        if (isNaN(targetScore)) return;

        // Animation Config
        const duration = 4000; // 4 seconds
        const startTimestamp = performance.now();

        // Strict Range Logic (0-19, 20-39, 40-59, 60-79, 80-100)
        // Colors: Low=Blue, Med=Yellow, High=Orange (#ff9f43), Crit=Red, Max=Purple
        function getRiskData(s) {
            if (s >= 80) return { color: '#a29bfe', text: 'RIESGO MÁXIMO', glow: 'rgba(162, 155, 254, 0.2)' };
            if (s >= 60) return { color: '#ff7675', text: 'RIESGO CRÍTICO', glow: 'rgba(255, 118, 117, 0.2)' };
            if (s >= 40) return { color: '#ff9f43', text: 'RIESGO ALTO', glow: 'rgba(255, 159, 67, 0.2)' }; // Orange
            if (s >= 20) return { color: '#ffeaa7', text: 'RIESGO MEDIO', glow: 'rgba(255, 234, 167, 0.2)' };
            return { color: '#74b9ff', text: 'RIESGO BAJO', glow: 'rgba(116, 185, 255, 0.2)' };
        }

        function step(timestamp) {
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            const currentScore = Math.floor(progress * targetScore);

            // Get Dynamic Data
            const riskData = getRiskData(currentScore);

            // Update Content
            scoreEl.innerText = currentScore;
            labelEl.innerText = riskData.text;

            // Update Styles (Dynamic Color & Glow)
            scoreEl.style.color = riskData.color;
            // Label can inherit or be explicit. Let's be explicit to ensure sync.
            // boxEl.style.borderColor = riskData.color; 
            // Note: CSS might override if specific classes are present, but inline styles normally win.

            boxEl.style.borderColor = riskData.color;
            boxEl.style.boxShadow = `0 0 20px ${riskData.glow}`;
            // Optional: Subtle background tint
            boxEl.style.backgroundColor = riskData.glow.replace('0.2', '0.05');

            if (progress < 1) {
                window.requestAnimationFrame(step);
            } else {
                // Final State (Ensure exact match)
                scoreEl.innerText = targetScore;
                const finalData = getRiskData(targetScore);

                labelEl.innerText = finalData.text;
                scoreEl.style.color = finalData.color;
                boxEl.style.borderColor = finalData.color;
                boxEl.style.boxShadow = `0 0 20px ${finalData.glow}`;
                boxEl.style.backgroundColor = finalData.glow.replace('0.2', '0.05');
            }
        }

        // Start Animation
        window.requestAnimationFrame(step);
    });
</script>

        <!-- Vectors Section (Premium Cards) -->
        <section class="vectors-section" style="padding-top: 0;">
    <h2 class="section-title" style="margin-top: 0;">Vectores de Vulnerabilidad</h2>
    <div class="divider-left"></div>

    
    <div class="vector-card maximum">
        <div class="vector-header">
            <div class="vector-id">VEC-001</div>
            <div class="vector-title">Credenciales de Base de Datos Expuestas</div>
            <div class="vector-irv-badge maximum">
                <span class="irv-value">85</span>
                <span class="irv-level">Máximo</span>
            </div>
        </div>

        <div class="vector-meta-grid">
            <div class="meta-item">
                <span class="label">Activo:</span>
                <span class="value">Base de Datos Prod (AWS RDS)</span>
            </div>
            <div class="meta-item">
                <span class="label">Tipo:</span>
                <span class="value">Infraestructura Cloud</span>
            </div>
            <div class="meta-item">
                <span class="label">Exposición:</span>
                <span class="value">Fuga en Repo Público</span>
            </div>
        </div>

        <div class="vector-body-new">
            <!-- Row 1: Action Cards (Ruta & Impacto) -->
            <div class="vector-action-grid">
                <div class="action-card remediation">
                    <h4 class="sub-header">Ruta de Cierre</h4>
                    <ol class="remediation-list">
                        
                        <li>Revocar las credenciales IAM de AWS expuestas inmediatamente.</li>
                        
                        <li>Rotar la contraseña maestra de la base de datos.</li>
                        
                        <li>Auditar logs de CloudTrail buscando actividad sospechosa desde la fecha del commit.</li>
                        
                        <li>Implementar git-secrets para prevenir futuros commits de secretos.</li>
                        
                    </ol>
                </div>

                <div class="action-card impact">
                    <h4 class="sub-header">Impacto</h4>
                    <ul class="impact-list">
                        
                        <li>Compromiso total de datos de clientes (PII).</li>
                        
                        <li>Potencial interrupción total del servicio (Ransomware).</li>
                        
                        <li>Multas regulatorias severas (GDPR/Ley de Datos). </li>
                        
                    </ul>
                </div>
            </div>

            <!-- Row 2: Description (Sober & Elegant) -->
            <div class="description-card">
                <h4 class="sub-header-simple">Descripción del Evento</h4>
                <p class="description-text">Se identificaron credenciales hardcodeadas para la base de datos principal de producción en un repositorio público de GitHub (config.js). El análisis de logs confirmó eventos de clonación no autorizados.</p>
            </div>
        </div>
    </div>
    
    <div class="vector-card critical">
        <div class="vector-header">
            <div class="vector-id">VEC-002</div>
            <div class="vector-title">Portal de Administración sin MFA</div>
            <div class="vector-irv-badge critical">
                <span class="irv-value">60</span>
                <span class="irv-level">Crítico</span>
            </div>
        </div>

        <div class="vector-meta-grid">
            <div class="meta-item">
                <span class="label">Activo:</span>
                <span class="value">admin.acme.com</span>
            </div>
            <div class="meta-item">
                <span class="label">Tipo:</span>
                <span class="value">Aplicación Web</span>
            </div>
            <div class="meta-item">
                <span class="label">Exposición:</span>
                <span class="value">Control Faltante</span>
            </div>
        </div>

        <div class="vector-body-new">
            <!-- Row 1: Action Cards (Ruta & Impacto) -->
            <div class="vector-action-grid">
                <div class="action-card remediation">
                    <h4 class="sub-header">Ruta de Cierre</h4>
                    <ol class="remediation-list">
                        
                        <li>Forzar MFA (OTP basado en tiempo) para todos los roles administrativos.</li>
                        
                        <li>Restringir el acceso solo a VPN o IPs de confianza.</li>
                        
                        <li>Implementar limitación de tasa (rate-limiting) en el endpoint de login.</li>
                        
                    </ol>
                </div>

                <div class="action-card impact">
                    <h4 class="sub-header">Impacto</h4>
                    <ul class="impact-list">
                        
                        <li>Acceso administrativo no autorizado.</li>
                        
                        <li>Manipulación o eliminación de datos.</li>
                        
                        <li>Instalación de puertas traseras (Backdoors).</li>
                        
                    </ul>
                </div>
            </div>

            <!-- Row 2: Description (Sober & Elegant) -->
            <div class="description-card">
                <h4 class="sub-header-simple">Descripción del Evento</h4>
                <p class="description-text">El panel administrativo permite autenticación de un solo factor. Ataques de fuerza bruta o relleno de credenciales podrían comprometer fácilmente una cuenta de administrador.</p>
            </div>
        </div>
    </div>
    
    <div class="vector-card medium">
        <div class="vector-header">
            <div class="vector-id">VEC-003</div>
            <div class="vector-title">Certificado SSL Desactualizado</div>
            <div class="vector-irv-badge medium">
                <span class="irv-value">35</span>
                <span class="irv-level">Medio</span>
            </div>
        </div>

        <div class="vector-meta-grid">
            <div class="meta-item">
                <span class="label">Activo:</span>
                <span class="value">dev.acme.com</span>
            </div>
            <div class="meta-item">
                <span class="label">Tipo:</span>
                <span class="value">Entorno de Desarrollo</span>
            </div>
            <div class="meta-item">
                <span class="label">Exposición:</span>
                <span class="value">Configuración</span>
            </div>
        </div>

        <div class="vector-body-new">
            <!-- Row 1: Action Cards (Ruta & Impacto) -->
            <div class="vector-action-grid">
                <div class="action-card remediation">
                    <h4 class="sub-header">Ruta de Cierre</h4>
                    <ol class="remediation-list">
                        
                        <li>Aprovisionar un nuevo certificado (ej. LetsEncrypt).</li>
                        
                        <li>Automatizar la renovación vía Certbot.</li>
                        
                    </ol>
                </div>

                <div class="action-card impact">
                    <h4 class="sub-header">Impacto</h4>
                    <ul class="impact-list">
                        
                        <li>Disrupción del flujo de trabajo de los desarrolladores.</li>
                        
                        <li>Riesgo de Man-in-the-Middle (MitM) si se usa externamente.</li>
                        
                        <li>Pérdida de validación de confianza.</li>
                        
                    </ul>
                </div>
            </div>

            <!-- Row 2: Description (Sober & Elegant) -->
            <div class="description-card">
                <h4 class="sub-header-simple">Descripción del Evento</h4>
                <p class="description-text">El certificado SSL para el entorno de desarrollo ha expirado, provocando advertencias en el navegador y exponiendo el tráfico a interceptación.</p>
            </div>
        </div>
    </div>
    
</section>

        <!-- Technical Annex (Methodology) -->
        <div class="annex-page">
    <div class="annex-header">
        <h1 class="annex-title">Anexo Técnico</h1>
    </div>

    <!-- SECTION 1: IRV -->
    <div class="annex-section">
        <h2 class="annex-h2">Índice de Riesgo del Vector (IRV)</h2>
        <p class="annex-p">
            El <strong>IRV</strong> es la métrica fundamental de urgencia. No mide el riesgo teórico, sino la necesidad
            operativa de cierre.
            Se calcula internamente mediante un modelo ponderado de seis dimensiones.
        </p>

        <!-- CLEAN FORMULA BLOCK -->
        <div class="formula-block">
            <span class="formula-label">Fórmula de Cálculo</span>
            <div class="formula-text">
                IRV = [ Σ(Componente × Peso) / Σ(Peso Máximo) ] × 100
            </div>
        </div>

        <h3 style="font-size:1rem; color:#fff; margin-top:3rem; margin-bottom:1rem; font-weight:700;">Variables del
            Modelo</h3>

        <!-- CLEAN VARIABLE GRID -->
        <div class="variable-grid">
            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Criticidad (CA)</span>
                    <span class="var-badge">x4</span>
                </div>
                <span class="var-desc">Importancia crítica del activo para la continuidad del negocio.</span>
            </div>

            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Exposición (ET)</span>
                    <span class="var-badge">x3</span>
                </div>
                <span class="var-desc">Ventana de tiempo y vigencia actual del hallazgo.</span>
            </div>

            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Superficie (SE)</span>
                    <span class="var-badge">x3</span>
                </div>
                <span class="var-desc">Facilidad de acceso desde redes públicas o privadas.</span>
            </div>

            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Impacto (IM)</span>
                    <span class="var-badge">x4</span>
                </div>
                <span class="var-desc">Suma de impactos (Financiero, Legal, Operativo, Reputacional).</span>
            </div>

            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Explotación (FE)</span>
                    <span class="var-badge">x3</span>
                </div>
                <span class="var-desc">Recursos y complejidad técnica requerida para el ataque.</span>
            </div>

            <div class="annex-card">
                <div class="var-header">
                    <span class="var-name">Detección (DV)</span>
                    <span class="var-badge">x3</span>
                </div>
                <span class="var-desc">Probabilidad de evasión de sistemas de monitoreo.</span>
            </div>
        </div>
    </div>

    <!-- SECTION 2: IRD -->
    <div class="annex-section">
        <h2 class="annex-h2">Índice de Riesgo Digital (IRD)</h2>
        <p class="annex-p">
            El <strong>IRD</strong> es el indicador de postura global. Se deriva dinámicamente de los vectores activos
            mediante
            un promedio ponderado por severidad.
        </p>

        <!-- CLEAN FORMULA BLOCK -->
        <div class="formula-block">
            <span class="formula-label">Agregación Ponderada</span>
            <div class="formula-text">
                IRD = Σ(IRV × Peso Severidad) / Σ(Pesos Severidad)
            </div>
        </div>

        <h3 style="font-size:1rem; color:#fff; margin-top:3rem; margin-bottom:1rem; font-weight:700;">Matriz de Pesos
        </h3>

        <!-- COMPONENT: CLEAN SEVERITY ROW -->
        <div class="severity-row">
            <div class="severity-item">
                <div class="sev-dot" style="background: #74b9ff;"></div>
                <span class="sev-label">Bajo</span>
                <span class="sev-mult">Multiplicador x1</span>
            </div>

            <div class="severity-item">
                <div class="sev-dot" style="background: #ffeaa7;"></div>
                <span class="sev-label">Medio</span>
                <span class="sev-mult">Multiplicador x2</span>
            </div>

            <div class="severity-item">
                <div class="sev-dot" style="background: #ff9f43;"></div>
                <span class="sev-label">Alto</span>
                <span class="sev-mult">Multiplicador x3</span>
            </div>

            <div class="severity-item">
                <div class="sev-dot" style="background: #ff7675;"></div>
                <span class="sev-label">Crítico</span>
                <span class="sev-mult">Multiplicador x4</span>
            </div>

            <div class="severity-item">
                <div class="sev-dot" style="background: #a29bfe;"></div>
                <span class="sev-label">Máximo</span>
                <span class="sev-mult">Multiplicador x5</span>
            </div>
        </div>
    </div>

    <!-- FOOTER NOTE -->
    <div class="annex-footer">
        Protegiendo la información que importa · <a href="https://private.felipemiramontesr.net/aviso-privacidad.html"
            target="_blank" class="privacy-link">Aviso de Privacidad</a>
    </div>
</div>

    </div>
</body>

</html>